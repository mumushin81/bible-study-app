import fs from 'fs'
import path from 'path'

interface VerseInfo {
  verse: number
  hebrew: string
}

// 창세기 3장 - 20개 빈 구절 (15, 16, 21, 24는 이미 완료됨)
const verses: VerseInfo[] = [
  {
    verse: 1,
    hebrew: 'וְהַנָּחָשׁ, הָיָה עָרוּם, מִכֹּל חַיַּת הַשָּׂדֶה, אֲשֶׁר עָשָׂה יְהוָה אֱלֹהִים; וַיֹּאמֶר, אֶל-הָאִשָּׁה, אַף כִּי-אָמַר אֱלֹהִים, לֹא תֹאכְלוּ מִכֹּל עֵץ הַגָּן.'
  },
  {
    verse: 2,
    hebrew: 'וַתֹּאמֶר הָאִשָּׁה, אֶל-הַנָּחָשׁ:  מִפְּרִי עֵץ-הַגָּן, נֹאכֵל.'
  },
  {
    verse: 3,
    hebrew: 'וּמִפְּרִי הָעֵץ, אֲשֶׁר בְּתוֹךְ-הַגָּן--אָמַר אֱלֹהִים לֹא תֹאכְלוּ מִמֶּנּוּ, וְלֹא תִגְּעוּ בּוֹ:  פֶּן-תְּמֻתוּן.'
  },
  {
    verse: 4,
    hebrew: 'וַיֹּאמֶר הַנָּחָשׁ, אֶל-הָאִשָּׁה:  לֹא-מוֹת, תְּמֻתוּן.'
  },
  {
    verse: 5,
    hebrew: 'כִּי, יֹדֵעַ אֱלֹהִים, כִּי בְּיוֹם אֲכָלְכֶם מִמֶּנּוּ, וְנִפְקְחוּ עֵינֵיכֶם; וִהְיִיתֶם, כֵּאלֹהִים, יֹדְעֵי, טוֹב וָרָע.'
  },
  {
    verse: 6,
    hebrew: 'וַתֵּרֶא הָאִשָּׁה כִּי טוֹב הָעֵץ לְמַאֲכָל וְכִי תַאֲוָה-הוּא לָעֵינַיִם, וְנֶחְמָד הָעֵץ לְהַשְׂכִּיל, וַתִּקַּח מִפִּרְיוֹ, וַתֹּאכַל; וַתִּתֵּן גַּם-לְאִישָׁהּ עִמָּהּ, וַיֹּאכַל.'
  },
  {
    verse: 7,
    hebrew: 'וַתִּפָּקַחְנָה, עֵינֵי שְׁנֵיהֶם, וַיֵּדְעוּ, כִּי עֵירֻמִּם הֵם; וַיִּתְפְּרוּ עֲלֵה תְאֵנָה, וַיַּעֲשׂוּ לָהֶם חֲגֹרֹת.'
  },
  {
    verse: 8,
    hebrew: 'וַיִּשְׁמְעוּ אֶת-קוֹל יְהוָה אֱלֹהִים, מִתְהַלֵּךְ בַּגָּן--לְרוּחַ הַיּוֹם; וַיִּתְחַבֵּא הָאָדָם וְאִשְׁתּוֹ, מִפְּנֵי יְהוָה אֱלֹהִים, בְּתוֹךְ, עֵץ הַגָּן.'
  },
  {
    verse: 9,
    hebrew: 'וַיִּקְרָא יְהוָה אֱלֹהִים, אֶל-הָאָדָם; וַיֹּאמֶר לוֹ, אַיֶּכָּה.'
  },
  {
    verse: 10,
    hebrew: 'וַיֹּאמֶר, אֶת-קֹלְךָ שָׁמַעְתִּי בַּגָּן; וָאִירָא כִּי-עֵירֹם אָנֹכִי, וָאֵחָבֵא.'
  },
  {
    verse: 11,
    hebrew: 'וַיֹּאמֶר--מִי הִגִּיד לְךָ, כִּי עֵירֹם אָתָּה; הֲמִן-הָעֵץ, אֲשֶׁר צִוִּיתִיךָ לְבִלְתִּי אֲכָל-מִמֶּנּוּ--אָכָלְתָּ.'
  },
  {
    verse: 12,
    hebrew: 'וַיֹּאמֶר, הָאָדָם:  הָאִשָּׁה אֲשֶׁר נָתַתָּה עִמָּדִי, הִוא נָתְנָה-לִּי מִן-הָעֵץ וָאֹכֵל.'
  },
  {
    verse: 13,
    hebrew: 'וַיֹּאמֶר יְהוָה אֱלֹהִים לָאִשָּׁה, מַה-זֹּאת עָשִׂית; וַתֹּאמֶר, הָאִשָּׁה, הַנָּחָשׁ הִשִּׁיאַנִי, וָאֹכֵל.'
  },
  {
    verse: 14,
    hebrew: 'וַיֹּאמֶר יְהוָה אֱלֹהִים אֶל-הַנָּחָשׁ, כִּי עָשִׂיתָ זֹּאת, אָרוּר אַתָּה מִכָּל-הַבְּהֵמָה, וּמִכֹּל חַיַּת הַשָּׂדֶה; עַל-גְּחֹנְךָ תֵלֵךְ, וְעָפָר תֹּאכַל כָּל-יְמֵי חַיֶּיךָ.'
  },
  {
    verse: 17,
    hebrew: 'וּלְאָדָם אָמַר, כִּי-שָׁמַעְתָּ לְקוֹל אִשְׁתֶּךָ, וַתֹּאכַל מִן-הָעֵץ, אֲשֶׁר צִוִּיתִיךָ לֵאמֹר לֹא תֹאכַל מִמֶּנּוּ--אֲרוּרָה הָאֲדָמָה, בַּעֲבוּרֶךָ, בְּעִצָּבוֹן תֹּאכְלֶנָּה, כֹּל יְמֵי חַיֶּיךָ.'
  },
  {
    verse: 18,
    hebrew: 'וְקוֹץ וְדַרְדַּר, תַּצְמִיחַ לָךְ; וְאָכַלְתָּ, אֶת-עֵשֶׂב הַשָּׂדֶה.'
  },
  {
    verse: 19,
    hebrew: 'בְּזֵעַת אַפֶּיךָ, תֹּאכַל לֶחֶם, עַד שׁוּבְךָ אֶל-הָאֲדָמָה, כִּי מִמֶּנָּה לֻקָּחְתָּ:  כִּי-עָפָר אַתָּה, וְאֶל-עָפָר תָּשׁוּב.'
  },
  {
    verse: 20,
    hebrew: 'וַיִּקְרָא הָאָדָם שֵׁם אִשְׁתּוֹ, חַוָּה:  כִּי הִוא הָיְתָה, אֵם כָּל-חָי.'
  },
  {
    verse: 22,
    hebrew: 'וַיֹּאמֶר יְהוָה אֱלֹהִים, הֵן הָאָדָם הָיָה כְּאַחַד מִמֶּנּוּ, לָדַעַת, טוֹב וָרָע; וְעַתָּה פֶּן-יִשְׁלַח יָדוֹ, וְלָקַח גַּם מֵעֵץ הַחַיִּים, וְאָכַל, וָחַי לְעֹלָם.'
  },
  {
    verse: 23,
    hebrew: 'וַיְשַׁלְּחֵהוּ יְהוָה אֱלֹהִים, מִגַּן-עֵדֶן--לַעֲבֹד, אֶת-הָאֲדָמָה, אֲשֶׁר לֻקַּח, מִשָּׁם.'
  }
]

// 10개 배치로 나누기 (각 배치당 2개씩)
const batches: VerseInfo[][] = [
  verses.slice(0, 2),    // 배치 1: 1-2절 (2개)
  verses.slice(2, 4),    // 배치 2: 3-4절 (2개)
  verses.slice(4, 6),    // 배치 3: 5-6절 (2개)
  verses.slice(6, 8),    // 배치 4: 7-8절 (2개)
  verses.slice(8, 10),   // 배치 5: 9-10절 (2개)
  verses.slice(10, 12),  // 배치 6: 11-12절 (2개)
  verses.slice(12, 14),  // 배치 7: 13-14절 (2개)
  verses.slice(14, 16),  // 배치 8: 17-18절 (2개)
  verses.slice(16, 18),  // 배치 9: 19-20절 (2개)
  verses.slice(18, 20),  // 배치 10: 22-23절 (2개)
]

function createPromptFile(batchNum: number, verses: VerseInfo[]) {
  const verseList = verses.map(v =>
    `**${v.verse}절**: ${v.hebrew}`
  ).join('\n')

  const verseNumbers = verses.map(v => v.verse).join(', ')

  const content = `━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📖 구절 컨텐츠 생성 요청 - 배치 ${batchNum}/10 (병렬 작업용)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

## 작업 정보
- **장**: 창세기 3장
- **구절**: ${verseNumbers}절
- **배치**: ${batchNum}/10
- **병렬 처리**: 10개 배치 동시 생성 중

## 히브리어 원문

${verseList}

## 작업 지시

위 구절들에 대해 **VERSE_CREATION_GUIDELINES.md**의 모든 지침을 따라 컨텐츠를 생성해주세요.

### 필수 포함 사항

각 구절마다:

1. **IPA 발음 기호**: 정확한 히브리어 발음
2. **한글 발음**: 한국어 화자를 위한 발음 표기
3. **현대어 번역**: 자연스러운 한국어 번역
4. **단어 분석**: 각 단어의 의미, 문법, 신학적 의미, 이모지
5. **주석**: 체계적인 4단계 구조
   - intro: 구절 소개
   - sections: 4-6개 섹션 (히브리어 제목 필수!)
   - whyQuestion: "왜" 질문
   - conclusion: 적용과 마무리

### 출력 형식

결과를 **data/generated/genesis_3_batch${batchNum}.json** 파일로 저장해주세요.

JSON 배열 형태로, 각 구절이 다음 구조를 가집니다:

\`\`\`json
[
  {
    "verseId": "genesis_3_1",
    "ipa": "...",
    "koreanPronunciation": "...",
    "modern": "...",
    "words": [...],
    "commentary": {...}
  }
]
\`\`\`

### 중요 주의사항

⚠️ **섹션 제목에 히브리어 필수!**
- 형식: "히브리어 (한글 발음) - 설명"
- 예시: "נָחָשׁ (나하쉬) - 뱀의 정체"
- 히브리어가 없으면 검증 실패!

📋 **VERSE_CREATION_GUIDELINES.md의 모든 규칙 준수**

---
**배치 작업**: 다른 배치들과 독립적으로 작업 가능합니다.
**최종 목표**: 창세기 3장 전체 컨텐츠 완성!
`

  const filename = `genesis_3_batch${batchNum}.md`
  const filepath = path.join(process.cwd(), 'data', 'prompts', filename)

  fs.writeFileSync(filepath, content, 'utf-8')
  console.log(`✅ 생성 완료: ${filename}`)
}

// 모든 배치 파일 생성
console.log('🚀 창세기 3장 - 10개 배치 프롬프트 파일 생성 시작...\n')

batches.forEach((batch, index) => {
  createPromptFile(index + 1, batch)
})

console.log('\n✨ 완료! 10개 배치 프롬프트 파일이 data/prompts/ 디렉토리에 생성되었습니다.')
console.log('📌 다음 단계: 10개 병렬 에이전트로 컨텐츠 생성 시작!')
