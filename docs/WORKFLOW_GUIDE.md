# ğŸ“– ì„±ê²½ ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì¶• ì›Œí¬í”Œë¡œìš° ê°€ì´ë“œ

## ğŸ¯ ëª©í‘œ

íˆë¸Œë¦¬ì–´ ì›ë¬¸ì„ í¬ë¡¤ë§í•˜ì—¬ Supabaseì— ì €ì¥í•˜ê³ , í’ˆì§ˆì„ ê²€ì¦í•œ í›„, AIë¡œ ì»¨í…ì¸ ë¥¼ ìƒì„±í•˜ëŠ” ì²´ê³„ì ì¸ ì‹œìŠ¤í…œ

---

## ğŸ“ ìƒˆë¡œìš´ ë””ë ‰í† ë¦¬ êµ¬ì¡°

```
scripts/
â”œâ”€â”€ bible-cli.ts           # ğŸ® í†µí•© CLI ë„êµ¬
â”œâ”€â”€ utils/                 # ğŸ”§ ê³µí†µ ìœ í‹¸ë¦¬í‹°
â”‚   â”œâ”€â”€ logger.ts         # ë¡œê¹…
â”‚   â”œâ”€â”€ supabase.ts       # Supabase í´ë¼ì´ì–¸íŠ¸
â”‚   â””â”€â”€ constants.ts      # ì±… ì •ë³´, ìƒìˆ˜
â”œâ”€â”€ crawl/                 # ğŸ•·ï¸ í¬ë¡¤ë§
â”‚   â”œâ”€â”€ index.ts          # ë©”ì¸ ì§„ì…ì 
â”‚   â”œâ”€â”€ initBooks.ts      # Books í…Œì´ë¸” ì´ˆê¸°í™”
â”‚   â”œâ”€â”€ fetchPage.ts      # Firecrawl API
â”‚   â”œâ”€â”€ parseVerses.ts    # êµ¬ì ˆ íŒŒì‹±
â”‚   â”œâ”€â”€ saveToDB.ts       # DB ì €ì¥
â”‚   â”œâ”€â”€ crawlChapter.ts   # ì¥ ë‹¨ìœ„ í¬ë¡¤ë§
â”‚   â””â”€â”€ crawlBook.ts      # ì±… ë‹¨ìœ„ í¬ë¡¤ë§
â”œâ”€â”€ verify/                # âœ… ê²€ì¦
â”‚   â”œâ”€â”€ index.ts          # í†µí•© ê²€ì¦
â”‚   â”œâ”€â”€ checkMissing.ts   # ëˆ„ë½ ê²€ì‚¬
â”‚   â””â”€â”€ checkDuplicates.ts # ì¤‘ë³µ ê²€ì‚¬
â””â”€â”€ generate/              # ğŸ¤– ì»¨í…ì¸  ìƒì„± (ì¶”í›„ êµ¬í˜„)
    â””â”€â”€ (ì˜ˆì •)
```

---

## ğŸš€ ë¹ ë¥¸ ì‹œì‘

### 1ï¸âƒ£ Books í…Œì´ë¸” ì´ˆê¸°í™”

Torah 5ê¶Œ(ì°½ì„¸ê¸°~ì‹ ëª…ê¸°) ë©”íƒ€ë°ì´í„°ë¥¼ Supabaseì— ì €ì¥í•©ë‹ˆë‹¤.

```bash
npm run bible:init
```

**ì¶œë ¥ ì˜ˆì‹œ:**
```
ğŸ“š Books í…Œì´ë¸” ì´ˆê¸°í™” ì‹œì‘
âœ… Supabase ì—°ê²° ì™„ë£Œ
âœ… ì°½ì„¸ê¸° (×‘×¨××©×™×ª) - 50ì¥
âœ… ì¶œì• êµ½ê¸° (×©××•×ª) - 40ì¥
âœ… ë ˆìœ„ê¸° (×•×™×§×¨×) - 27ì¥
âœ… ë¯¼ìˆ˜ê¸° (×‘××“×‘×¨) - 36ì¥
âœ… ì‹ ëª…ê¸° (×“×‘×¨×™×) - 34ì¥
âœ… Books í…Œì´ë¸” ì´ˆê¸°í™” ì™„ë£Œ! ğŸ‰
```

---

### 2ï¸âƒ£ íˆë¸Œë¦¬ì–´ ì›ë¬¸ í¬ë¡¤ë§

mechon-mamre.orgì—ì„œ íˆë¸Œë¦¬ì–´ ì›ë¬¸ì„ í¬ë¡¤ë§í•˜ì—¬ `verses` í…Œì´ë¸”ì— ì €ì¥í•©ë‹ˆë‹¤.

#### ë‹¨ì¼ ì¥ í¬ë¡¤ë§
```bash
npm run bible:crawl genesis 1
```

#### ë²”ìœ„ í¬ë¡¤ë§
```bash
npm run bible:crawl genesis 1 10
```

#### ì±… ì „ì²´ í¬ë¡¤ë§
```bash
npm run bible:crawl genesis
```

**ì¶œë ¥ ì˜ˆì‹œ:**
```
ğŸ“š ì°½ì„¸ê¸° í¬ë¡¤ë§ ì‹œì‘ (1ì¥~50ì¥)
ğŸ“Š [1/50] 2% - ì°½ì„¸ê¸° 1ì¥
ğŸ“– ì°½ì„¸ê¸° 1ì¥ í¬ë¡¤ë§ ì‹œì‘
â„¹ï¸  URL: https://mechon-mamre.org/p/pt/pt0101.htm
â„¹ï¸  Firecrawl APIë¡œ í¬ë¡¤ë§: ...
âœ… í¬ë¡¤ë§ ì„±ê³µ: 5847 ë°”ì´íŠ¸
â„¹ï¸  ì¶”ì¶œëœ êµ¬ì ˆ: 31ê°œ
âœ… ì €ì¥ ì™„ë£Œ: ì°½ì„¸ê¸° 1:1
âœ… ì €ì¥ ì™„ë£Œ: ì°½ì„¸ê¸° 1:2
...
âœ… ì°½ì„¸ê¸° 1ì¥ ì™„ë£Œ! (ì„±ê³µ: 31, ì‹¤íŒ¨: 0)
```

**ì €ì¥ë˜ëŠ” ë°ì´í„°:**
- âœ… `id`: `genesis_1_1`
- âœ… `book_id`: `genesis`
- âœ… `chapter`: `1`
- âœ… `verse_number`: `1`
- âœ… `reference`: `ì°½ì„¸ê¸° 1:1`
- âœ… `hebrew`: `×‘Ö°Ö¼×¨Öµ××©Ö´××™×ª ×‘Ö¸Ö¼×¨Ö¸×...` (íˆë¸Œë¦¬ì–´ ì›ë¬¸)
- â¸ï¸ `ipa`: `` (ë‚˜ì¤‘ì— ì¶”ê°€)
- â¸ï¸ `korean_pronunciation`: `` (ë‚˜ì¤‘ì— ì¶”ê°€)
- â¸ï¸ `modern`: `` (ë‚˜ì¤‘ì— ì¶”ê°€)

---

### 3ï¸âƒ£ ë°ì´í„° ê²€ì¦

í¬ë¡¤ë§í•œ ë°ì´í„°ì˜ ì¤‘ë³µê³¼ ëˆ„ë½ì„ ê²€ì‚¬í•©ë‹ˆë‹¤.

#### ì „ì²´ ê²€ì¦ (ì¤‘ë³µ + ëˆ„ë½)
```bash
npm run bible:verify
```

#### ì¤‘ë³µ ê²€ì‚¬ë§Œ
```bash
npm run bible:check-duplicates
```

#### ëˆ„ë½ ê²€ì‚¬ë§Œ
```bash
npm run bible:check-missing
```

#### íŠ¹ì • ì±…ë§Œ ê²€ì‚¬
```bash
npm run bible:verify genesis
npm run bible:check-missing genesis
npm run bible:check-duplicates genesis
```

**ì¶œë ¥ ì˜ˆì‹œ:**
```
ğŸ” í†µí•© ë°ì´í„° ê²€ì¦ ì‹œì‘

1ï¸âƒ£ ì¤‘ë³µ êµ¬ì ˆ ê²€ì‚¬
ğŸ“– ì°½ì„¸ê¸° ì¤‘ë³µ êµ¬ì ˆ ê²€ì‚¬
ğŸ“Š ê²€ì‚¬ ê²°ê³¼
â„¹ï¸  ì´ êµ¬ì ˆ: 1533ê°œ
âœ… ID ì¤‘ë³µ ì—†ìŒ
âœ… íˆë¸Œë¦¬ì–´ í…ìŠ¤íŠ¸ ì¤‘ë³µ ì—†ìŒ

2ï¸âƒ£ ëˆ„ë½ êµ¬ì ˆ ê²€ì‚¬
ğŸ“– ì°½ì„¸ê¸° ëˆ„ë½ êµ¬ì ˆ ê²€ì‚¬
ğŸ“Š ê²€ì‚¬ ê²°ê³¼
â„¹ï¸  ì´ ì˜ˆìƒ êµ¬ì ˆ: 1533ê°œ
â„¹ï¸  ì‹¤ì œ êµ¬ì ˆ: 1530ê°œ
âš ï¸  ëˆ„ë½ëœ êµ¬ì ˆ: 3ê°œ

ëˆ„ë½ ëª©ë¡:
  - ì°½ì„¸ê¸° 5:12 (ID: genesis_5_12)
  - ì°½ì„¸ê¸° 10:8 (ID: genesis_10_8)
  - ì°½ì„¸ê¸° 22:15 (ID: genesis_22_15)

âœ… ê²€ì¦ ì™„ë£Œ
```

---

## ğŸ“‹ ì „ì²´ ì›Œí¬í”Œë¡œìš°

### ìƒˆ ì±… ì¶”ê°€ ì‹œë‚˜ë¦¬ì˜¤ (ì˜ˆ: ì¶œì• êµ½ê¸°)

```bash
# 1. Books í…Œì´ë¸”ì— ë©”íƒ€ë°ì´í„°ê°€ ìˆëŠ”ì§€ í™•ì¸ (ì´ˆê¸°í™” ì‹œ ìë™ ì¶”ê°€ë¨)
npm run bible:init

# 2. ì¶œì• êµ½ê¸° ì „ì²´ í¬ë¡¤ë§
npm run bible:crawl exodus

# 3. ê²€ì¦
npm run bible:verify exodus

# 4. ëˆ„ë½ëœ êµ¬ì ˆì´ ìˆë‹¤ë©´ í•´ë‹¹ ì¥ë§Œ ë‹¤ì‹œ í¬ë¡¤ë§
npm run bible:crawl exodus 5  # 5ì¥ë§Œ ë‹¤ì‹œ í¬ë¡¤ë§

# 5. ë‹¤ì‹œ ê²€ì¦
npm run bible:verify exodus
```

---

## ğŸ› ï¸ í†µí•© CLI ë„êµ¬

`npm run bible` ëª…ë ¹ì–´ë¡œ ëª¨ë“  ê¸°ëŠ¥ì— ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ë„ì›€ë§
```bash
npm run bible help
```

### ì‚¬ìš© ê°€ëŠ¥í•œ ëª…ë ¹ì–´

| ëª…ë ¹ì–´ | ì„¤ëª… | ì˜ˆì‹œ |
|--------|------|------|
| `init-books` | Books í…Œì´ë¸” ì´ˆê¸°í™” | `npm run bible init-books` |
| `crawl <bookId> [start] [end]` | íˆë¸Œë¦¬ì–´ ì›ë¬¸ í¬ë¡¤ë§ | `npm run bible crawl genesis 1 10` |
| `verify [bookId]` | ë°ì´í„° ê²€ì¦ | `npm run bible verify genesis` |

---

## ğŸ“Š í˜„ì¬ ìƒíƒœ í™•ì¸

### Supabaseì—ì„œ SQLë¡œ í™•ì¸

```sql
-- ì´ êµ¬ì ˆ ìˆ˜
SELECT COUNT(*) FROM verses;

-- ì±…ë³„ êµ¬ì ˆ ìˆ˜
SELECT book_id, COUNT(*) as verse_count
FROM verses
GROUP BY book_id
ORDER BY book_id;

-- ìµœê·¼ ì¶”ê°€ëœ êµ¬ì ˆ
SELECT * FROM verses
ORDER BY created_at DESC
LIMIT 10;

-- íŠ¹ì • ì¥ì˜ êµ¬ì ˆë“¤
SELECT reference, LEFT(hebrew, 30) as hebrew_preview
FROM verses
WHERE book_id = 'genesis' AND chapter = 1
ORDER BY verse_number;

-- ë¹ˆ í•„ë“œ í™•ì¸ (ì»¨í…ì¸  ìƒì„± í•„ìš”í•œ êµ¬ì ˆ)
SELECT COUNT(*)
FROM verses
WHERE ipa = '' OR korean_pronunciation = '' OR modern = '';
```

---

## âš™ï¸ ì„¤ì •

### í™˜ê²½ ë³€ìˆ˜ (.env.local)

```bash
# Supabase
VITE_SUPABASE_URL=https://your-project.supabase.co
VITE_SUPABASE_ANON_KEY=your-anon-key
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key  # ì„ íƒì‚¬í•­

# Firecrawl (ìë™ ì„¤ì •ë¨)
FIRECRAWL_API_KEY=fc-650c644774d3424fa7e1c49fdfdbd444
```

### í¬ë¡¤ë§ ì†ë„ ì¡°ì ˆ

`scripts/crawl/crawlBook.ts`ì˜ `delayMs` ìˆ˜ì •:

```typescript
export interface CrawlBookOptions {
  delayMs?: number // ê¸°ë³¸ê°’: 2000ms (2ì´ˆ)
}
```

---

## ğŸ¯ ë‹¤ìŒ ë‹¨ê³„

### Phase 3: ì»¨í…ì¸  ìƒì„± ìë™í™” (ì˜ˆì •)

```bash
# ê³„íš ì¤‘ì¸ ëª…ë ¹ì–´ë“¤
npm run bible:generate genesis     # IPA, ë°œìŒ, ë²ˆì—­, ë‹¨ì–´, ì£¼ì„ ìƒì„±
npm run bible:generate-missing     # ë¹ˆ í•„ë“œë§Œ ë³´ì¶©
npm run bible:status               # ì§„í–‰ ìƒí™© í™•ì¸
```

---

## ğŸ› ë¬¸ì œ í•´ê²°

### 1. Firecrawl API ì—ëŸ¬
```
âŒ Firecrawl API ì—ëŸ¬: 429 - Rate limit exceeded
```
**í•´ê²°:** `crawlBook.ts`ì˜ `delayMs`ë¥¼ ëŠ˜ë¦¬ì„¸ìš” (ì˜ˆ: 3000ms)

### 2. Supabase ì—°ê²° ì‹¤íŒ¨
```
âŒ VITE_SUPABASE_URLì´ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.
```
**í•´ê²°:** `.env.local` íŒŒì¼ í™•ì¸

### 3. êµ¬ì ˆì„ ì°¾ì„ ìˆ˜ ì—†ìŒ
```
âš ï¸  êµ¬ì ˆì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
```
**í•´ê²°:** ì›¹ í˜ì´ì§€ êµ¬ì¡°ê°€ ë³€ê²½ë˜ì—ˆì„ ìˆ˜ ìˆìŒ. `parseVerses.ts`ì˜ ì •ê·œí‘œí˜„ì‹ í™•ì¸

---

## ğŸ’¡ íŒ

1. **ì†Œê·œëª¨ í…ŒìŠ¤íŠ¸ ë¨¼ì €**: ì „ì²´ ì±…ì„ í¬ë¡¤ë§í•˜ê¸° ì „ì— 1-2ì¥ë§Œ í…ŒìŠ¤íŠ¸í•˜ì„¸ìš”.
2. **ì •ê¸°ì ì¸ ê²€ì¦**: í¬ë¡¤ë§ í›„ í•­ìƒ ê²€ì¦ì„ ì‹¤í–‰í•˜ì„¸ìš”.
3. **ë°±ì—…**: ëŒ€ëŸ‰ ì‘ì—… ì „ì— Supabaseì—ì„œ ë°ì´í„° ë°±ì—…ì„ ê¶Œì¥í•©ë‹ˆë‹¤.
4. **Rate Limit**: API ì œí•œì„ ê³ ë ¤í•˜ì—¬ ëŒ€ê¸° ì‹œê°„ì„ ì ì ˆíˆ ì„¤ì •í•˜ì„¸ìš”.

---

## ğŸ“ ì§€ì›

ë¬¸ì œê°€ ë°œìƒí•˜ë©´:
1. ë¡œê·¸ í™•ì¸
2. í™˜ê²½ ë³€ìˆ˜ í™•ì¸
3. Supabase ë°ì´í„°ë² ì´ìŠ¤ ìƒíƒœ í™•ì¸
4. GitHub Issuesì— ë¬¸ì˜

---

**í–‰ë³µí•œ ì½”ë”© ë˜ì„¸ìš”!** ğŸš€
